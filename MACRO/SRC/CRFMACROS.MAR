	.TITLE	CRF_MACROS 
	.IDENT	'V03-000'

;
;****************************************************************************
;*									    *
;*  COPYRIGHT (c) 1978, 1980, 1982 BY					    *
;*  DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASSACHUSETTS.		    *
;*  ALL RIGHTS RESERVED.						    *
;* 									    *
;*  THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY BE USED AND COPIED   *
;*  ONLY IN  ACCORDANCE WITH  THE  TERMS  OF  SUCH  LICENSE  AND WITH THE   *
;*  INCLUSION OF THE ABOVE COPYRIGHT NOTICE. THIS SOFTWARE OR  ANY  OTHER   *
;*  COPIES THEREOF MAY NOT BE PROVIDED OR OTHERWISE MADE AVAILABLE TO ANY   *
;*  OTHER PERSON.  NO TITLE TO AND OWNERSHIP OF  THE  SOFTWARE IS  HEREBY   *
;*  TRANSFERRED.							    *
;* 									    *
;*  THE INFORMATION IN THIS SOFTWARE IS  SUBJECT TO CHANGE WITHOUT NOTICE   *
;*  AND  SHOULD  NOT  BE  CONSTRUED AS  A COMMITMENT BY DIGITAL EQUIPMENT   *
;*  CORPORATION.							    *
;* 									    *
;*  DIGITAL ASSUMES NO RESPONSIBILITY FOR THE USE  OR  RELIABILITY OF ITS   *
;*  SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DIGITAL.		    *
;* 									    *
;*									    *
;****************************************************************************
;

;++
; FACILITY:  CROSS REFERENCE PROGRAM
;
; ABSTRACT:  ACCEPTS CROSS REFERENCE DATA AND PRODUCES A SUMMARY
;
;
; ENVIRONMENT:  LINKABLE IMAGE TO BE USED WITH THE NATIVE MODE LINKER AND COMPILERS
;
; AUTHOR:  K.D. MORSE	, CREATION DATE:  12-APR-77
;
; MODIFIED BY:
;
;	, : VERSION
; 01	- 
;--

	.SBTTL	DECLARATIONS
;
; INCLUDE FILES:
;

;
; MACROS:
;

;
; MACRO TO INITIALIZE THE OUTPUT LINE DESCRIPTION TABLE
;
; $CRFCONTROLTBL	OUT_RTN,ERR_RTN,KEY_TYPE,KEY1TABLE,KEY2TABLE,-
;			VAL1TABLE,VAL2TABLE,REF1TABLE,REF2TABLE
;
; WHERE
;
;	ERR_RTN = ADDRESS OF USER'S ERROR ROUTINE
;	OUT_RTN = ADDRESS OF USER'S OUTPUT ROUTINE
;	KEY_TYPE = TYPE OF KEY, 0=ASCIC, 1=BINARY LONGWORD
;	KEY1TABLE = ADDRESS OF KEY1 FIELD DESCRIPTION TABLE
;	KEY2TABLE = ADDRESS OF KEY2 FIELD DESCRIPTION TABLE
;	VAL1TABLE = ADDRESS OF VAL1 FIELD DESCRIPTION TABLE
;	VAL2TABLE = ADDRESS OF VAL2 FIELD DESCRIPTION TABLE
;	REF1TABLE = ADDRESS OF REF1 FIELD DESCRIPTION TABLE
;	REF2TABLE = ADDRESS OF REF2 FIELD DESCRIPTION TABLE
;
	.MACRO	$CRFCONTROLTBL	OUT_RTN,ERR_RTN,KEY_TYPE=0,KEY1TABLE,-
				KEY2TABLE,VAL1TABLE,VAL2TABLE,REF1TABLE,-
				REF2TABLE

	.LONG	0				; TREE LISTHEAD-ROOT
	.WORD	CRF$K_ENTSIZE			; SIZE OF ONE CRF ENTRY
	.WORD	CRF$K_NODSIZE			; SIZE OF ONE CRF NODE
	.BYTE	KEY_TYPE			; TYPE OF KEY
	.BYTE	0				; CRF FLAGS
	.WORD	0				; SECONDARY ERROR STATUS CODE
	.LONG	ERR_RTN				; ADDR OF ERROR ROUTINE
	.LONG	OUT_RTN				; ADDR OF OUTPUT ROUTINE
						; ADDRESSES OF FIELD DESCRIPTIONS
	.LONG	KEY1TABLE			; KEY1 FIELD DESCRIPTIONS
	.LONG	KEY2TABLE			; KEY2 FIELD DESCRIPTIONS
	.LONG	VAL1TABLE			; VAL1 FIELD DESCRIPTIONS
	.LONG	VAL2TABLE			; VAL2 FIELD DESCRIPTIONS
	.LONG	REF1TABLE			; REF1 FIELD DESCRIPTIONS
	.LONG	REF2TABLE			; REF2 FIELD DESCRIPTION
	.ENDM					; END OF INIT MACRO


;
; MACRO TO DEFINE ONE FIELD OF THE OUTPUT LINE
;
; $CRFFIELD	BIT_MASK,FAO_STRING,FIELD_WIDTH,SET_CLEAR
;
; WHERE:
;
;	BIT_MASK=MASK OF BITS INDICATING THIS OUTPUT DESCRIPTION HOLDS
;	FAO_STRING=FAO CONTROL STRING FOR THIS FIELD
;	FIELD_WIDTH=MAXIMUM SIZE OF THIS OUTPUT LINE FIELD
;	SET_CLEAR=INDICATOR HOW TO TEST MASK BITS, I.E. ONE OF THE FOLLOWING:
;		SET=MASK BITS ARE TO BE TESTED AS SET
;		CLEAR=MASK BITS ARE TO BE TESTED AS CLEAR
;

	.MACRO	$CRFFIELD	BIT_MASK=0,FAO_STRING,FIELD_WIDTH,SET_CLEAR

	.SAVE					; REMEMBER USER'S PSECT
	.PSECT	$$CRFSTRNG,RD,WRT,REL,NOEXE,NOSHR
$$$LNG1=.					; ADDRESS OF FAO CONTROL STRING
	.ASCII	\FAO_STRING\			; OUTPUT FIELD CONTROL STRING
$$$LNG2=.					; INDICATOR FOR LENGTH

	.RESTORE				; RESTORE USER'S PSECT
	.WORD	BIT_MASK!^X8000			; RECORD MASK BITS

	.IF	IDN	<SET_CLEAR>,<CLEAR>	; DETERMINE WHETHER
	.BYTE	0				; MASK IS TO BE CLEAR
	.IFF					; OR IF
	.BYTE	1				; MASK IS TO BE SET
	.ENDC					;

	.BYTE	FIELD_WIDTH			; MAXIMUM SIZE OF FIELD

	.LONG	$$$LNG2-$$$LNG1			; STRING DESCRIPTOR
	.LONG	$$$LNG1				; FOR FAO CONTROL STRING

	.ENDM					; END OF FIELD DESCRIPTION MACRO

;
; MACRO TO INDICATE END OF OUTPUT LINE DESCRIPTION TABLE
;
; $CRFFIELDEND
;
; WHERE:
;
;	THERE ARE NO FORMAL PARAMETERS.
;

	.MACRO	$CRFFIELDEND			;

	.WORD	0				; END FIELD DESCRIPTIONS

	.ENDM					; END OF MACRO
