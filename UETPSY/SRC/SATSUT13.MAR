	.TITLE	SATSUT13	SATS SYSTEM SERVICE TESTS
	.SBTTL	MACROS, DATA
	.IDENT	'V03-000'

;****************************************************************************
;*									    *
;*  COPYRIGHT (c) 1978, 1980, 1982 BY					    *
;*  DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASSACHUSETTS.		    *
;*  ALL RIGHTS RESERVED.						    *
;* 									    *
;*  THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY BE USED AND COPIED   *
;*  ONLY IN  ACCORDANCE WITH  THE  TERMS  OF  SUCH  LICENSE  AND WITH THE   *
;*  INCLUSION OF THE ABOVE COPYRIGHT NOTICE. THIS SOFTWARE OR  ANY  OTHER   *
;*  COPIES THEREOF MAY NOT BE PROVIDED OR OTHERWISE MADE AVAILABLE TO ANY   *
;*  OTHER PERSON.  NO TITLE TO AND OWNERSHIP OF  THE  SOFTWARE IS  HEREBY   *
;*  TRANSFERRED.							    *
;* 									    *
;*  THE INFORMATION IN THIS SOFTWARE IS  SUBJECT TO CHANGE WITHOUT NOTICE   *
;*  AND  SHOULD  NOT  BE  CONSTRUED AS  A COMMITMENT BY DIGITAL EQUIPMENT   *
;*  CORPORATION.							    *
;* 									    *
;*  DIGITAL ASSUMES NO RESPONSIBILITY FOR THE USE  OR  RELIABILITY OF ITS   *
;*  SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DIGITAL.		    *
;* 									    *
;*									    *
;****************************************************************************

	.PAGE
	.PSECT	RWDATA,RD,WRT,NOEXE
CREPID:		.LONG	0	; PID OF CREATED (THIS) PROCESS
LOGNAM_PID:	STRING	I,<SYSTST$PID> ; LOG NAME OF PID OF CREATING PROCESS
EQUIV_PID:	STRING	O,4	; BUFFER FOR CREATING PID (EQUIVALENCE NAME)
; *
; *	THIS ROUTINE RUNS IN A  PROCESS CREATED BY
; *	A PROCESS RUNNING THE SATSSS42 IMAGE.  THIS PROCESS
; *	OBTAINS ITS PID FOR LATER USE, SIGNALS THE CREATING PROCESS
; *	(VIA $WAKE) THAT IT IS FULLY CREATED, AND THEN HIBERNATES,
; *	ANTICIPATING EITHER A $WAKE FROM THE CREATING PROCESS,
; *	OR A $FORCEX FROM THE CREATING PROCESS. IF THE CREATOR
; *	ISSUES $WAKE, THEN THIS PROCESS DOES ITS OWN $FORCEX,
; *	USING ITS PID AS AN EXIT COMPLETION STATUS CODE.
; *	THE STATUS CODE WILL BE CHECKED FOR CORRECTNESS BY 
; *	THE CREATING PROCESS THROUGH THE USE OF THE
; *	PROCESS TERMINATION MAILBOX MECHANISM.
; *
	.PAGE
	.SBTTL	EXECUTABLE CODE
	.PSECT	SATSUT13,RD,WRT,EXE
START:	.WORD	0	; ENTRY MASK
SATSUT13:
	$WAKE_S	CREPID		; OBTAIN PID OF THIS PROCESS
	$HIBER_S		; UNDO ABOVE WAKE
	$TRNLOG_S LOGNAM=LOGNAM_PID, - ; GET CREATOR'S PID FROM SYSTEM LOG NAME TBL
		  RSLBUF=EQUIV_PID,  -
		  DSBMSK=#^B110
	$WAKE_S PIDADR=EQUIV_PID+8; SIGNAL TO CREATOR: THIS PROC IS FULLY CREATED
	$HIBER_S		; SLEEP WHILE CREATOR DECIDES TO $WAKE OR $FORCEX
;
; ****** SYSTEM SERVICE CALL WHICH IS THE SUBJECT OF THIS TEST CASE ******
;
	$FORCEX_S CODE=CREPID	; ISSUE SUBJECT FORCEX WITH PID AS STATUS CODE
	.END	START
