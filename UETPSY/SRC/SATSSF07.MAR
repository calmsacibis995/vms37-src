	.TITLE	SATSSF07 - SATS SYSTEM SERVICE TESTS  (FAILING S.C.)
	.IDENT	'V03-000'

;
;****************************************************************************
;*									    *
;*  COPYRIGHT (c) 1978, 1980, 1982 BY					    *
;*  DIGITAL EQUIPMENT CORPORATION, MAYNARD, MASSACHUSETTS.		    *
;*  ALL RIGHTS RESERVED.						    *
;* 									    *
;*  THIS SOFTWARE IS FURNISHED UNDER A LICENSE AND MAY BE USED AND COPIED   *
;*  ONLY IN  ACCORDANCE WITH  THE  TERMS  OF  SUCH  LICENSE  AND WITH THE   *
;*  INCLUSION OF THE ABOVE COPYRIGHT NOTICE. THIS SOFTWARE OR  ANY  OTHER   *
;*  COPIES THEREOF MAY NOT BE PROVIDED OR OTHERWISE MADE AVAILABLE TO ANY   *
;*  OTHER PERSON.  NO TITLE TO AND OWNERSHIP OF  THE  SOFTWARE IS  HEREBY   *
;*  TRANSFERRED.							    *
;* 									    *
;*  THE INFORMATION IN THIS SOFTWARE IS  SUBJECT TO CHANGE WITHOUT NOTICE   *
;*  AND  SHOULD  NOT  BE  CONSTRUED AS  A COMMITMENT BY DIGITAL EQUIPMENT   *
;*  CORPORATION.							    *
;* 									    *
;*  DIGITAL ASSUMES NO RESPONSIBILITY FOR THE USE  OR  RELIABILITY OF ITS   *
;*  SOFTWARE ON EQUIPMENT WHICH IS NOT SUPPLIED BY DIGITAL.		    *
;* 									    *
;*									    *
;****************************************************************************
;

;++
; FACILITY:	SATS SYSTEM SERVICE TESTS
;
; ABSTRACT:	THE SATSSF07 MODULE TESTS THE EXECUTION OF CERTAIN
; VMS SYSTEM SERVICES, INVOKED IN SUCH A WAY AS TO EXPECT FAILING
; STATUS CODES. THE SYSTEM SERVICES TESTED AND THE STATUS CODES
; EXPECTED ARE SUMMARIZED AS ARGUMENTS TO THE TESTSERV MACROS
; WHICH APPEAR NEAR THE END OF THIS LISTING. SUCCESSFUL STATUS
; CODES ARE TESTED IN OTHER MODULES.
;
;
; ENVIRONMENT:	USER MODE IMAGE; NEEDS CMKRNL PRIVILEGE,
;		DYNAMICALLY ACQUIRES OTHER PRIVILEGES, AS NEEDED.
;
; AUTHOR: THOMAS L. CAFARELLA,		CREATION DATE: MMM, 1978
;	  PAUL D. FAY (DISPSERV & TESTSERV MACROS)
;
; MODIFIED BY:
;
;		VERSION 1.50 : 25-MAY-79
;
; 01  PJT  06/21/79	Changed UNKN2 (missing arg.) variable definition
;			to UNKN2_GJP to fix GETJPI failure.
;
; 02  PJT  08/31/79	Changed PHD, PCB, and STS assignments to
;			reference the system definitions.
;--
	.PAGE
	.SBTTL	DECLARATIONS
;
; INCLUDE FILES:
;
	$PRVDEF				; SYMBOL DEFS FOR PRIVILEGES
	$UETPDEF			; UETP MSG CODE DEFINITIONS
	$SHR_MESSAGES UETP,116,<<TEXT,INFO>> 
					; DEFINE UETP$_TEXT
	$DIBDEF				; DEFINE DEVICE INFO BLOCK OFFSETS
	$JPIDEF				; DEFINE $GETJPI IDENTIFIERS
	$PHDDEF				; PROCESS HEADER DEFINITION
	$PCBDEF				; PROCESS CONTROL BLOCK DEFINITION
	$STSDEF				; STATUS DEFINITION
;
; MACROS:
;
;
; EQUATED SYMBOLS:
;
WARNING		= 0			; WARNING SEVERITY VALUE FOR MSGS
SUCCESS		= 1			; SUCCESS SEVERITY VALUE FOR MSGS
ERROR		= 2			; ERROR SEVERITY VALUE FOR MSGS
INFO		= 3			; INFORMATIONAL SEV VALUE FOR MSGS
SEVERE		= 4			; SEVERE (FATAL) SEV VALUE FOR MSGS
TCG_NO		=  0			; INITIALIZE TEST CASE GROUP NUMBER
GRP_TOTAL	=  0			; INITIALIZE TEST CASE GROUP TOTAL
R0_THRU_SP	= ^M<R0,R1,R2,R3,R4,R5,R6,R7,R8,R9,R10,R11,AP,FP,SP>
DETFLAG		= 64			; EVENT FLAG NO. FOR DETACHED PROC
PIDADR_CWK10	= 1			; PIDADR ARG FOR CANWAK (LOCATION 1)
PIDADR_WAK10	= 1			; PIDADR ARG FOR WAKE (LOCATION 1)
PIDADR_DPC10	= 1			; PIDADR ARG FOR DELPRC (LOCATION 1)
PIDADR_GJP20	= 1			; PIDADR ARG FOR GETJPI (LOCATION 1)
UNKN2_GJP	= 0			; UNKN2 ARG FOR GETJPI (MISSING ARG)
;
; OWN STORAGE:
;
	.PAGE
	.PSECT	RODATA,RD,NOWRT,NOEXE,LONG
REG_COMP_MASK:	.WORD	^M<R2,R3,R4,R5,R6,R7,R8,R9,R10,R11,AP,FP> ! ^X8000 -
					; REG COMPARE MASK (HIGH-ORDER ... 
					; ... BIT MUST BE ON
ERR_MSG_FAOCTL:	STRING	I,<!/!AC!1ZB!1ZB: REGISTER !2UW CONTENTS ALTERED>, -
		<;  BEFORE SERVICE CALL: !8XL   AFTER SERVICE CALL: !8XL>
TEST_MOD_NAME:	STRING	C,<SATSSF07>	; TEST MODULE NAME
TEST_MOD_BEG:	STRING	C,<begun>	; DISPOSITION FIELD OF TEST MOD MSG
TEST_MOD_SUCC:	STRING	C,<successful>	; DISPOSITION FIELD OF TEST MOD MSG
TEST_MOD_FAIL:	STRING	C,<failed>	; DISPOSITION FIELD OF TEST MOD MSG
TEST_MOD_NAME_D: STRING	I,<SATSSF07>	; TEST MODULE NAME DESCRIPTOR
TTNAME:     	STRING  I,<TT>		; TERMINAL LOGICAL NAME
INADR:		.LONG	NOACCESS,NOACCESS ; PAGE ADDRESS OF NOACCESS PSECT
PROT:		.LONG	PRT$C_NA	; PROTECTION CODE FOR NOACCESS PSECT
ONES:		.LONG	-1,-1		; A QUADWORD OF 1-BITS
DETIMAGE:	STRING	I,<SYSTST$RES:SATSUT01.EXE>
					; IMAGE NAME FOR DETACHED PROCESS
DETNAME:	STRING	I,<SATSSF07_DET> ; PRCNAM & MBOX NAME FOR DET PROC
PRCNAM_CWK29	= DETNAME		; PRCNAM ARGUMENT FOR CANWAK
PRCNAM_WAK29	= DETNAME		; PRCNAM ARGUMENT FOR WAKE
PRCNAM_DPC29	= DETNAME		; PRCNAM ARGUMENT FOR DELPRC
PRCNAM_GJP34	= DETNAME		; PRCNAM ARGUMENT FOR GETJPI
PRCNAM_CWK:	STRING	I,<SATSSF07>	; PRCNAM ARGUMENT FOR CANWAK
PRCNAM_CWK24:	.LONG	1		; PRCNAM ARGUMENT FOR CANWAK
		.ADDRESS NOACCESS	; ......
PRCNAM_CWK26:	STRING	I,<SFCWK26>	; PRCNAM ARGUMENT FOR CANWAK
PRCNAM_CWK27:	.LONG	0		; PRCNAM ARGUMENT FOR CANWAK
PRCNAM_CWK28:	STRING	I,<SIXTEEN CHARS$$$> 
					; PRCNAM ARGUMENT FOR CANWAK
PRCNAM_WAK:	STRING	I,<SATSSF07>	; PRCNAM ARGUMENT FOR WAKE
PRCNAM_WAK24:	.LONG	1		; PRCNAM ARGUMENT FOR WAKE
		.ADDRESS NOACCESS	; ......
PRCNAM_WAK26:	STRING	I,<SFWAK26>	; PRCNAM ARGUMENT FOR WAKE
PRCNAM_WAK27:	.LONG	0		; PRCNAM ARGUMENT FOR WAKE
PRCNAM_WAK28:	STRING	I,<SIXTEEN CHARS$$$> 
					; PRCNAM ARGUMENT FOR WAKE
PRCNAM_DPC:	STRING	I,<SATSSF07>	; PRCNAM ARGUMENT FOR DELPRC
PRCNAM_DPC24:	.LONG	1		; PRCNAM ARGUMENT FOR DELPRC
		.ADDRESS NOACCESS	; ......
PRCNAM_DPC26:	STRING	I,<SFDPC26>	; PRCNAM ARGUMENT FOR DELPRC
PRCNAM_DPC27:	.LONG	0		; PRCNAM ARGUMENT FOR DELPRC
PRCNAM_DPC28:	STRING	I,<SIXTEEN CHARS$$$> 
					; PRCNAM ARGUMENT FOR DELPRC
PRCNAM_GJP:	STRING	I,<SATSSF07>	; PRCNAM ARGUMENT FOR GETJPI
PRCNAM_GJP31:	STRING	I,<SFGJP31>	; PRCNAM ARGUMENT FOR GETJPI
PRCNAM_GJP32:	.LONG	0		; PRCNAM ARGUMENT FOR GETJPI
PRCNAM_GJP33:	STRING	I,<SIXTEEN CHARS$$$> 
					; PRCNAM ARGUMENT FOR GETJPI
UNKN1_GJP:	.LONG	0		; UNKN1 ARGUMENT FOR GETJPI
ITMLST_GJP:	.WORD	4	    	; ITMLST ARGUMENT FOR GETJPI
		.WORD	JPI$_PID
		.LONG	JPIPID
		.LONG	0,0
ITMLST_GJP41:	.WORD	4	    	; ITMLST ARGUMENT FOR GETJPI
		.WORD	^XFFFE
		.LONG	JPIPID
		.LONG	0,0
	.PAGE
	.PSECT	RWDATA,RD,WRT,NOEXE
TPID:		.BLKL	1		; PROCESS ID FOR THIS PROCESS
CURRENT_TC:	.BLKL	1 		; PTR TO CURRENT TEST CASE
REG_SAVE_AREA:	.BLKL	15		; SAVE AREA FOR ALL REGS (SANS PC)
MOD_MSG_CODE:	.LONG	UETP$_SATSMS	; TEST MODULE MSG CODE FOR PUTMSG
CLOB_REG_NO:	.BLKL	1		; CLOBBERED REG NO (FOR FAO ERR MSG)
REG_BEFORE_SS:	.BLKL	1		; REG CONTENTS BEFORE S.S. 
					; ... (FOR FAO ERROR MSG)
REG_AFTER_SS:	.BLKL	1		; REG CONTENTS AFTER S.S. 
					; ... (FOR FAO ERROR MSG)
$$TSTN$$:	STRING	C,<  SF   >	; ASCII PORTION OF TEST CASE NAME
TMN_ADDR:	.ADDRESS TEST_MOD_NAME	; ADDR OF TEST MOD NAME FOR FAO
TMD_ADDR:	.ADDRESS TEST_MOD_BEG	; ADDR OF T.M. DISP FIELD FOR FAO
TS_EP:		.BLKL	1		; ENTRY PNT FOR CURR TESTSERV MACRO
RETADR:		.BLKL	2		; RETURN LONGWORDS FOR SETPRT
PRVPRT:		.BLKB	1		; PROT RETURN BYTE FOR SETPRT
PRIVMASK:	.BLKQ	1		; ADDR OF PRIVILEGE MASK (IN PHD)
CHM_CONT:	.BLKL	1		; CHANGE MODE CONTINUE ADDRESS
REGS:		.BLKL	5		; AREA FOR COND INDEX REGS (R2-R6)
DETUIC:		.BLKL	1		; UIC FOR DETACHED PROCESS
MBXCHAN:	.BLKL	1		; CHAN NO. FOR MBOX FOR CREATED PROC
MBXCHANINFO:	STRING	O,75		; CHANNEL INFO RETURNED BY GETCHN
MBXUNIT:	.BLKL	1		; SAVE AREA FOR MAILBOX UNIT NUMBER
MBXBUFF:	STRING	O,120		; MAILBOX BUFFER FOR CREATED PROCESS
PIDADR_CWK:	.BLKL	1		; PIDADR ARGUMENT FOR CANWAK
PIDADR_CWK13:	.BLKL	1		; PIDADR ARGUMENT FOR CANWAK
PIDADR_CWK14:	.BLKL	1		; PIDADR ARGUMENT FOR CANWAK
PIDADR_WAK:	.BLKL	1		; PIDADR ARGUMENT FOR WAKE
PIDADR_WAK13:	.BLKL	1		; PIDADR ARGUMENT FOR WAKE
PIDADR_WAK14:	.BLKL	1		; PIDADR ARGUMENT FOR WAKE
PIDADR_DPC:	.BLKL	1		; PIDADR ARGUMENT FOR DELPRC
PIDADR_DPC13:	.BLKL	1		; PIDADR ARGUMENT FOR DELPRC
PIDADR_DPC14:	.BLKL	1		; PIDADR ARGUMENT FOR DELPRC
PIDADR_GJP:	.BLKL	1		; PIDADR ARGUMENT FOR GETJPI
PIDADR_GJP21:	.BLKL	1		; PIDADR ARGUMENT FOR GETJPI
PIDADR_GJP22:	.BLKL	1		; PIDADR ARGUMENT FOR GETJPI
JPIPID:		.BLKL	1		; USED BY GETJPI
	.PAGE
	.PSECT	SATS_ACCVIO_1,RD,WRT,NOEXE,PAGE
EMPTY:		.BLKB	512	; RESERVE A PAGE OF SPACE
;
; + 
; ******************************************************************
; *                                                                *
; * 	THE ORDER OF STATEMENTS IN THIS PSECT IS CRITICAL.         *
; *	DO NOT RE-ARRANGE THE VARIABLES. CONSULT SATS              *
; *	FUNCTIONAL SPECIFICATION FOR A DESCRIPTION OF THE USE      *
; *	OF THE EMPTY PSECT (AND ITS COMPANION PSECT, NOACCESS).    *
; *                                                                *
; ******************************************************************
; -
;
; TYPE AAAAA_SSSX1 (TYPE AAAAA_SSSX2 IF NOT DESC) GO HERE:
PIDADR_CWK12	= . - 1		; PIDADR ARGUMENT FOR CANWAK (LAST BYTE IN PAGE)
PRCNAM_CWK21	= . - 1		; PRCNAM ARGUMENT FOR CANWAK (LAST BYTE IN PAGE)
PIDADR_WAK12	= . - 1		; PIDADR ARGUMENT FOR WAKE (LAST BYTE IN PAGE)
PRCNAM_WAK21	= . - 1		; PRCNAM ARGUMENT FOR WAKE (LAST BYTE IN PAGE)
PIDADR_DPC12	= . - 1		; PIDADR ARGUMENT FOR DELPRC (LAST BYTE IN PAGE)
PRCNAM_DPC21	= . - 1		; PRCNAM ARGUMENT FOR DELPRC (LAST BYTE IN PAGE)
		. = . - 13	; ALLOW ROOM FOR STRING DESCRIPTOR
; TYPE AAAAA_SSSX5 GO HERE:
PRCNAM_CWK25:			; PRCNAM ARGUMENT FOR CANWAK
PRCNAM_WAK25:			; PRCNAM ARGUMENT FOR WAKE
PRCNAM_DPC25:			; PRCNAM ARGUMENT FOR DELPRC
		.LONG	6	; STRING LENGTH (WILL CROSS PSECT BOUNDARY)
		.ADDRESS .+4	; STRING ADDRESS
; TYPE AAAAA_SSSX3 GO HERE:
PRCNAM_CWK23:			; PRCNAM ARGUMENT FOR CANWAK
PRCNAM_WAK23:			; PRCNAM ARGUMENT FOR WAKE
PRCNAM_DPC23:			; PRCNAM ARGUMENT FOR DELPRC
		.BLKB	1	; LOW-ORDER BYTE OF STRING LENGTH
; TYPE AAAAA_SSSX2 GO HERE:
PRCNAM_CWK22:			; PRCNAM ARGUMENT FOR CANWAK
PRCNAM_WAK22:			; PRCNAM ARGUMENT FOR WAKE
PRCNAM_DPC22:			; PRCNAM ARGUMENT FOR DELPRC
		.BLKL	1	; STRING LENGTH
;
;
;
;
	.PSECT	SATS_ACCVIO_2,RD,WRT,NOEXE,PAGE
NOACCESS:	.BLKB	512	; RESERVE A PAGE OF SPACE
		. = . - 512	; RETURN LOC CTR TO BEGINNING OF PSECT
		.ADDRESS EMPTY	; ADDRESS OF ACCESSIBLE STRING
		.ADDRESS EMPTY/^X100 ; ADDRESS OF ACCESSIBLE STRING
;+
; *** NOTE -- DO NOT CHANGE LOCATION OR SEQUENCE OF ABOVE STATEMENTS!
; ***         THIS PSECT (NOACCESS) MUST APPEAR IN MEMORY IMMEDIATELY
; ***         FOLLOWING THE EMPTY PSECT. PSECT NAMES AND OPTIONS WILL BE 
; ***         CHOSEN TO FORCE THE DESIRED PSECT ORDERING.
;-
;
;
;
;
PIDADR_CWK11:	.LONG	0	; PIDADR ARGUMENT FOR CANWAK
PRCNAM_CWK20:	STRING	I,<SFCWK20> ; PRCNAM ARGUMENT FOR CANWAK
PIDADR_WAK11:	.LONG	0	; PIDADR ARGUMENT FOR WAKE
PRCNAM_WAK20:	STRING	I,<SFWAK20> ; PRCNAM ARGUMENT FOR WAKE
PIDADR_DPC11:	.LONG	0	; PIDADR ARGUMENT FOR DELPRC
PRCNAM_DPC20:	STRING	I,<SFDPC20> ; PRCNAM ARGUMENT FOR DELPRC
PRCNAM_GJP30:	STRING	I,<SFGJP30> ; PRCNAM ARGUMENT FOR GETJPI
ITMLST_GJP40:	.WORD	4	    ; ITMLST ARGUMENT FOR GETJPI
		.WORD	JPI$_PID
		.LONG	JPIPID
		.LONG	0,0
	.PSECT	SATSSF07,RD,WRT,EXE,LONG
	.PAGE
	.SBTTL	SATSSF07
;++
; FUNCTIONAL DESCRIPTION:
;
;		AFTER PERFORMING SOME INITIAL HOUSEKEEPING, SUCH AS
; PRINTING THE MODULE BEGIN MESSAGE AND ACQUIRING ALL PRIVILEGES,
; THE SATSSF07 ROUTINE EXECUTES THE TEST_SERV_EXEC MACRO TO RUN
; ALL TEST CASES. WHEN THE MACRO COMPLETES ITS EXECUTION, SATSSF07
; PRINTS A TEST MODULE SUCCESS OR FAIL MESSAGE AND EXITS TO THE
; OPERATING SYSTEM. TEST_SERV_EXEC CALLS THE TC_CONTROL/TESTSERV
; CO-ROUTINE PAIR ONCE PER TEST CASE GROUP TO EXECUTE ALL TEST
; CASES IN THAT GROUP. EACH TEST CASE GROUP IS DEFINED BY BOUNDING
; ITS TEST CASES WITH A TC_GROUP MACRO BEFORE THE FIRST TEST CASE
; AND A TCEND MACRO AFTER THE LAST ONE. THE TEST CASES THEMSELVES
; ARE DEFINED WITHIN THESE BOUNDS BY PRECEDING EACH WITH A
; NEXT_TEST_CASE MACRO. TC_CONTROL/TESTSERV EXECUTES THE CODE 
; FOLLOWING EACH NEXT_TEST_CASE MACRO IMMEDIATELY BEFORE ISSUING
; THE SYSTEM SERVICE AS REQUESTED IN THE TESTSERV MACRO. TC_CONTROL/
; TESTSERV ALSO CHECKS THE RESULTS OF THE SERVICE WITH RESPECT
; TO ITS EXPECTED STATUS CODE AND PRINTS ANY REQUIRED FAILURE
; MESSAGES FOR THE TEST CASE. THE CODE APPEARING AFTER EACH
; NEXT_TEST_CASE MACRO IS MERELY TO SET UP CONDITIONS REQUIRED
; FOR THE SYSTEM SERVICE AND TO CLEAN UP ANY RESOURCES ACQUIRED
; BY THE PREVIOUS TEST CASE.
;
; CALLING SEQUENCE:
;
;	$ RUN SATSSF07  ...  (DCL COMMAND)
;
; INPUT PARAMETERS:
;
;	NONE
;
; IMPLICIT INPUTS:
;
;	NONE
;
; OUTPUT PARAMETERS:
;
;	NONE
;
; IMPLICIT OUTPUTS:
;
;	MESSAGES TO SYS$OUTPUT ARE THE ONLY OUTPUT FROM SATSSF07.
;	THEY ARE OF THE FORM:
;
;		%UETP-S-SATSMS, TEST MODULE SATSSF07 BEGUN ... (BEGIN MSG)
;		%UETP-S-SATSMS, TEST MODULE SATSSF07 SUCCESSFUL ... (END MSG)
;		%UETP-E-SATSMS, TEST MODULE SATSSF07 FAILED ... (END MSG)
;		%UETP-I-TEXT, ... (VARIABLE INFORMATION ABOUT A TEST MODULE FAILURE)
;
; COMPLETION CODES:
;
;	THE SATSSF07 ROUTINE TERMINATES WITH A $EXIT TO THE
;	OPERATING SYSTEM WITH A STATUS CODE DEFINED BY UETP$_SATSMS.
;
; SIDE EFFECTS:
;
;	NONE
;
;--



SATSSF07:
	.WORD	^M<R2,R3,R4,R5,R6,R7,R8,R9,R10,R11>
					; ENTRY MASK
	$WAKE_S  TPID			; GET PID OF THIS PROCESS
	$HIBER_S			; UNDO WAKE
	$SETPRN_S TEST_MOD_NAME_D 	; SET PROCESS NAME
	BSBW	MOD_MSG_PRINT		; PRINT TEST MODULE BEGIN MSG
	MOVAL	TEST_MOD_SUCC,TMD_ADDR	; ASSUME END MSG WILL SHOW SUCCESS
	INSV	#SUCCESS,#0,#3,MOD_MSG_CODE ; ADJUST STATUS CODE FOR SUCCESS
	MODE	TO,10$,KRNL,NOREGS 	; KERNEL MODE TO ACCESS PHD
	MOVL	@#CTL$GL_PHD,R9		; GET PROCESS HEADER ADDRESS
	MOVAL	PHD$Q_PRIVMSK(R9),PRIVMASK ; GET PRIV MASK ADDRESS
	MODE	FROM,10$		; GET BACK TO USER MODE
	PRIV	ADD,ALL			; GET ALL PRIVILEGES
	$CREMBX_S CHAN=MBXCHAN, LOGNAM=DETNAME, - 
		  MAXMSG=#120, PROMSK=#0, BUFQUO=#240
					; GET MAILBOX FOR PROCESS
	$GETCHN_S CHAN=MBXCHAN, PRIBUF=MBXCHANINFO 
					; GET CHAN INFO (UNIT NUMBER)
	MOVZWL	MBXCHANINFO+8+DIB$W_UNIT,MBXUNIT 
					; SAVE MAILBOX UNIT NUMBER
	MODE	TO,20$,KRNL,NOREGS 	; KERNEL MODE TO ACCESS PCB
	MOVL	@#SCH$GL_CURPCB,R9 	; GET CURRENT PCB ADDRESS
	MOVL	PCB$L_UIC(R9),DETUIC 	; PICK UP UIC FROM PCB
	MODE	FROM,20$		; ... AND GET BACK TO USER MODE
	$CREPRC_S IMAGE=DETIMAGE, PRCNAM=DETNAME, -
		  UIC=DETUIC, MBXUNT=MBXUNIT
					; CREATE DETACHED PROC WITH SAME UIC
	DISPSERV			; SET UP DISPLAY INFO FOR TESTSERV
	$SETPRT_S INADR=INADR, RETADR=RETADR, -
		  PROT=PROT, PRVPRT=PRVPRT
					; SET NOACCESS PSECT ...
					; ... FOR NO USER ACCESS
	BRW	EXECUTE			; GO EXECUTE ALL TEST CASES
	TC_GROUP	CWK,1,TS1
;
	NEXT_TEST_CASE	SFCWK10
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK10
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_CWK10
; *
; *  INPUT CONDITIONS:
; *	PIDADR FIELD AT LOCATION 1
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	PRIV	ADD,ALL		; GET BACK SOME PRIVS REMOVED BY PRIOR T.C.
;
	NEXT_TEST_CASE	SFCWK11
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK11
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_CWK11
; *
; *  INPUT CONDITIONS:
; *	PIDADR FIELD IN NON-ACCESSIBLE PSECT
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
;
	NEXT_TEST_CASE	SFCWK12
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK12
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_CWK12
; *
; *  INPUT CONDITIONS:
; *	PIDADR FIELD BEGINS IN ACCESSIBLE PSECT, ENDS
; *	  IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
;
	NEXT_TEST_CASE	SFCWK13
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK13
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_CWK13
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS ID
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	MOVL	TPID,PIDADR_CWK13 ; GET A VALID PID
	CVTBW	#-1,PIDADR_CWK13  ; MAKE IT INVALID
;
	NEXT_TEST_CASE	SFCWK14
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK14
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_CWK14
; *
; *  INPUT CONDITIONS:
; *	VALID, NON-EXISTENT PROCESS ID
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	MOVL	TPID,PIDADR_CWK14 ; GET AN EXISTENT PID
	MOVW	#6000,PIDADR_CWK14+2 ; MAKE IT NON-EXISTENT
;
	NEXT_TEST_CASE	SFCWK20
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK20
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_CWK20
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR LENGTH FIELD IN
; *	  NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_CWK	; MAKE SURE PRCNAM IS USED BY CANWAK
;
	NEXT_TEST_CASE	SFCWK21
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK21
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_CWK21
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR LENGTH FIELD BEGINS IN
; *	  ACCESSIBLE PSECT, ENDS IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_CWK	; MAKE SURE PRCNAM IS USED BY CANWAK
;
	NEXT_TEST_CASE	SFCWK22
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK22
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_CWK22
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR ADDRESS FIELD IN
; *	  NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_CWK	; MAKE SURE PRCNAM IS USED BY CANWAK
	MOVZBL	#3,PRCNAM_CWK22	; ESTABLISH PRCNAM STRING LENGTH
;
	NEXT_TEST_CASE	SFCWK23
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK23
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_CWK23
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR ADDRESS FIELD BEGINS IN
; *	  ACCESSIBLE PSECT, ENDS IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_CWK	; MAKE SURE PRCNAM IS USED BY CANWAK
	MOVZBL	#3,PRCNAM_CWK23	; ESTABLISH PRCNAM STRING LENGTH
;
	NEXT_TEST_CASE	SFCWK24
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK24
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_CWK24
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING IN NON-ACCESSIBLE PSECT
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_CWK	; MAKE SURE PRCNAM IS USED BY CANWAK
;
	TCEND
	TC_GROUP	CWK,2,TS2
;
	NEXT_TEST_CASE	SFCWK25
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK25
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_CWK25
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING BEGINS IN ACCESSIBLE PSECT,
; *	  ENDS IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_CWK	; MAKE SURE PRCNAM IS USED BY CANWAK
;
	NEXT_TEST_CASE	SFCWK26
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK26
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_CWK26
; *
; *  INPUT CONDITIONS:
; *	NON-EXISTENT PROCESS NAME
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_CWK	; MAKE SURE PRCNAM IS USED BY CANWAK
;
	NEXT_TEST_CASE	SFCWK27
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK27
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_CWK27
; *

; *  INPUT CONDITIONS:
; *	INVALID PROCESS NAME (LENGTH 0)
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	IVLOGNAM
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_CWK	; MAKE SURE PRCNAM IS USED BY CANWAK
;
	NEXT_TEST_CASE	SFCWK28
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK28
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_CWK28
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS NAME (LENGTH 16)
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	IVLOGNAM
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_CWK	; MAKE SURE PRCNAM IS USED BY CANWAK
;
	NEXT_TEST_CASE	SFCWK29
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFCWK29
; *
; *  SYSTEM SERVICE:		CANWAK
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_CWK29
; *
; *  INPUT CONDITIONS:
; *	CANWAK ISSUED FOR EXISTING PROCESS WHICH IS NOT A
; *	  SUBPROCESS OF THIS PROCESS, AND THIS PROCESS HAS
; *	  NO GROUP OR WORLD PRIVILEGE.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NOPRIV
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	PRIV	REM,GROUP	; REMOVE GROUP PRIVILEGE
	PRIV	REM,WORLD	; REMOVE WORLD PRIVILEGE
	CLRL	PIDADR_CWK	; MAKE SURE PRCNAM IS USED BY CANWAK
;
	TCEND
	TC_GROUP	WAK,1,TS3
;
	NEXT_TEST_CASE	SFWAK10
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK10
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_WAK10
; *
; *  INPUT CONDITIONS:
; *	PIDADR FIELD AT LOCATION 1
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	PRIV	ADD,ALL		; GET BACK SOME PRIVS REMOVED BY PRIOR T.C.
;
	NEXT_TEST_CASE	SFWAK11
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK11
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_WAK11
; *
; *  INPUT CONDITIONS:
; *	PIDADR FIELD IN NON-ACCESSIBLE PSECT
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
;
	NEXT_TEST_CASE	SFWAK12
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK12
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_WAK12
; *
; *  INPUT CONDITIONS:
; *	PIDADR FIELD BEGINS IN ACCESSIBLE PSECT, ENDS
; *	  IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
;
	NEXT_TEST_CASE	SFWAK13
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK13
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_WAK13
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS ID
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	MOVL	TPID,PIDADR_WAK13 ; GET A VALID PID
	CVTBW	#-1,PIDADR_WAK13  ; MAKE IT INVALID
;
	NEXT_TEST_CASE	SFWAK14
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK14
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_WAK14
; *
; *  INPUT CONDITIONS:
; *	VALID, NON-EXISTENT PROCESS ID
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	MOVL	TPID,PIDADR_WAK14 ; GET AN EXISTENT PID
	MOVW	#6000,PIDADR_WAK14+2 ; MAKE IT NON-EXISTENT
;
	NEXT_TEST_CASE	SFWAK20
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK20
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_WAK20
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR LENGTH FIELD IN
; *	  NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_WAK	; MAKE SURE PRCNAM IS USED BY WAKE
;
	NEXT_TEST_CASE	SFWAK21
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK21
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_WAK21
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR LENGTH FIELD BEGINS IN
; *	  ACCESSIBLE PSECT, ENDS IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_WAK	; MAKE SURE PRCNAM IS USED BY WAKE
;
	NEXT_TEST_CASE	SFWAK22
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK22
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_WAK22
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR ADDRESS FIELD IN
; *	  NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_WAK	; MAKE SURE PRCNAM IS USED BY WAKE
	MOVZBL	#3,PRCNAM_WAK22	; ESTABLISH PRCNAM STRING LENGTH
;
	NEXT_TEST_CASE	SFWAK23
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK23
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_WAK23
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR ADDRESS FIELD BEGINS IN
; *	  ACCESSIBLE PSECT, ENDS IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_WAK	; MAKE SURE PRCNAM IS USED BY WAKE
	MOVZBL	#3,PRCNAM_WAK23	; ESTABLISH PRCNAM STRING LENGTH
;
	NEXT_TEST_CASE	SFWAK24
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK24
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_WAK24
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING IN NON-ACCESSIBLE PSECT
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_WAK	; MAKE SURE PRCNAM IS USED BY WAKE
;
	TCEND
	TC_GROUP	WAK,2,TS4
;
	NEXT_TEST_CASE	SFWAK25
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK25
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_WAK25
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING BEGINS IN ACCESSIBLE PSECT,
; *	  ENDS IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_WAK	; MAKE SURE PRCNAM IS USED BY WAKE
;
	NEXT_TEST_CASE	SFWAK26
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK26
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_WAK26
; *
; *  INPUT CONDITIONS:
; *	NON-EXISTENT PROCESS NAME
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_WAK	; MAKE SURE PRCNAM IS USED BY WAKE
;
	NEXT_TEST_CASE	SFWAK27
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK27
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_WAK27
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS NAME (LENGTH 0)
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	IVLOGNAM
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_WAK	; MAKE SURE PRCNAM IS USED BY WAKE
;
	NEXT_TEST_CASE	SFWAK28
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK28
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_WAK28
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS NAME (LENGTH 16)
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	IVLOGNAM
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_WAK	; MAKE SURE PRCNAM IS USED BY WAKE
;
	NEXT_TEST_CASE	SFWAK29
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFWAK29
; *
; *  SYSTEM SERVICE:		WAKE
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_WAK29
; *
; *  INPUT CONDITIONS:
; *	WAKE ISSUED FOR EXISTING PROCESS WHICH IS NOT A
; *	  SUBPROCESS OF THIS PROCESS, AND THIS PROCESS HAS
; *	  NO GROUP OR WORLD PRIVILEGE.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NOPRIV
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	PRIV	REM,GROUP	; REMOVE GROUP PRIVILEGE
	PRIV	REM,WORLD	; REMOVE WORLD PRIVILEGE
	CLRL	PIDADR_WAK	; MAKE SURE PRCNAM IS USED BY WAKE
;
	TCEND
	TC_GROUP	DPC,1,TS5
;
	NEXT_TEST_CASE	SFDPC10
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC10
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_DPC10
; *
; *  INPUT CONDITIONS:
; *	PIDADR FIELD AT LOCATION 1
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
;
	NEXT_TEST_CASE	SFDPC11
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC11
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_DPC11
; *
; *  INPUT CONDITIONS:
; *	PIDADR FIELD IN NON-ACCESSIBLE PSECT
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
;
	NEXT_TEST_CASE	SFDPC12
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC12
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_DPC12
; *
; *  INPUT CONDITIONS:
; *	PIDADR FIELD BEGINS IN ACCESSIBLE PSECT, ENDS
; *	  IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
;
	NEXT_TEST_CASE	SFDPC13
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC13
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_DPC13
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS ID
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	MOVL	TPID,PIDADR_DPC13 ; GET A VALID PID
	CVTBW	#-1,PIDADR_DPC13  ; MAKE IT INVALID
;
	NEXT_TEST_CASE	SFDPC14
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC14
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_DPC14
; *
; *  INPUT CONDITIONS:
; *	VALID, NON-EXISTENT PROCESS ID
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	MOVL	TPID,PIDADR_DPC14 ; GET AN EXISTENT PID
	MOVW	#6000,PIDADR_DPC14+2 ; MAKE IT NON-EXISTENT
;
	NEXT_TEST_CASE	SFDPC20
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC20
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_DPC20
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR LENGTH FIELD IN
; *	  NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_DPC	; MAKE SURE PRCNAM IS USED BY DELPRC
;
	NEXT_TEST_CASE	SFDPC21
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC21
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_DPC21
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR LENGTH FIELD BEGINS IN
; *	  ACCESSIBLE PSECT, ENDS IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_DPC	; MAKE SURE PRCNAM IS USED BY DELPRC
;
	NEXT_TEST_CASE	SFDPC22
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC22
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_DPC22
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR ADDRESS FIELD IN
; *	  NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_DPC	; MAKE SURE PRCNAM IS USED BY DELPRC
	MOVZBL	#3,PRCNAM_DPC22	; ESTABLISH PRCNAM STRING LENGTH
;
	NEXT_TEST_CASE	SFDPC23
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC23
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_DPC23
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING DESCRIPTOR ADDRESS FIELD BEGINS IN
; *	  ACCESSIBLE PSECT, ENDS IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_DPC	; MAKE SURE PRCNAM IS USED BY DELPRC
	MOVZBL	#3,PRCNAM_DPC23	; ESTABLISH PRCNAM STRING LENGTH
;
	NEXT_TEST_CASE	SFDPC24
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC24
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_DPC24
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING IN NON-ACCESSIBLE PSECT
; *

; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_DPC	; MAKE SURE PRCNAM IS USED BY DELPRC
;
	TCEND
	TC_GROUP	DPC,2,TS6
;
	NEXT_TEST_CASE	SFDPC25
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC25
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_DPC25
; *
; *  INPUT CONDITIONS:
; *	PRCNAM STRING BEGINS IN ACCESSIBLE PSECT,
; *	  ENDS IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_DPC	; MAKE SURE PRCNAM IS USED BY DELPRC
;
	NEXT_TEST_CASE	SFDPC26
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC26
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_DPC26
; *
; *  INPUT CONDITIONS:
; *	NON-EXISTENT PROCESS NAME
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_DPC	; MAKE SURE PRCNAM IS USED BY DELPRC
;
	NEXT_TEST_CASE	SFDPC27
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC27
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_DPC27
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS NAME (LENGTH 0)
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	IVLOGNAM
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_DPC	; MAKE SURE PRCNAM IS USED BY DELPRC
;
	NEXT_TEST_CASE	SFDPC28
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC28
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_DPC28
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS NAME (LENGTH 16)
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	IVLOGNAM
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_DPC	; MAKE SURE PRCNAM IS USED BY DELPRC
;
	NEXT_TEST_CASE	SFDPC29
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFDPC29
; *
; *  SYSTEM SERVICE:		DELPRC
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_DPC29
; *
; *  INPUT CONDITIONS:
; *	DELPRC ISSUED FOR EXISTING PROCESS WHICH IS NOT A
; *	  SUBPROCESS OF THIS PROCESS, AND THIS PROCESS HAS
; *	  NO GROUP OR WORLD PRIVILEGE.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NOPRIV
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	PRIV	REM,GROUP	; REMOVE GROUP PRIVILEGE
	PRIV	REM,WORLD	; REMOVE WORLD PRIVILEGE
	CLRL	PIDADR_DPC	; MAKE SURE PRCNAM IS USED BY DELPRC
;
	TCEND
	TC_GROUP	GJP,1,TS7
;
	NEXT_TEST_CASE	SFGJP20
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFGJP20
; *
; *  SYSTEM SERVICE:		GETJPI
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_GJP20
; *
; *  INPUT CONDITIONS:
; *	PIDADR FIELD AT LOCATION 1
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
;
	NEXT_TEST_CASE	SFGJP21
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFGJP21
; *
; *  SYSTEM SERVICE:		GETJPI
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_GJP21
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS ID
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	MOVL	TPID,PIDADR_GJP21 ; GET A VALID PID
	CVTBW	#-1,PIDADR_GJP21  ; MAKE IT INVALID
;
	NEXT_TEST_CASE	SFGJP22
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFGJP22
; *
; *  SYSTEM SERVICE:		GETJPI
; *
; *  ARGUMENT UNDER TEST: 	PIDADR_GJP22
; *
; *  INPUT CONDITIONS:
; *	VALID, NON-EXISTENT PROCESS ID
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	MOVL	TPID,PIDADR_GJP22 ; GET AN EXISTENT PID
	MOVW	#6000,PIDADR_GJP22+2 ; MAKE IT NON-EXISTENT
;
	NEXT_TEST_CASE	SFGJP30
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFGJP30
; *
; *  SYSTEM SERVICE:		GETJPI
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_GJP30
; *
; *  INPUT CONDITIONS:
; *	PRCNAM IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_GJP	; MAKE SURE PRCNAM IS USED BY GETJPI
;
	NEXT_TEST_CASE	SFGJP31
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFGJP31
; *
; *  SYSTEM SERVICE:		GETJPI
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_GJP31
; *
; *  INPUT CONDITIONS:
; *	NON-EXISTENT PROCESS NAME
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NONEXPR
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_GJP	; MAKE SURE PRCNAM IS USED BY GETJPI
;
	NEXT_TEST_CASE	SFGJP32
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFGJP32
; *
; *  SYSTEM SERVICE:		GETJPI
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_GJP32
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS NAME (LENGTH 0)
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	IVLOGNAM
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_GJP	; MAKE SURE PRCNAM IS USED BY GETJPI
;
	NEXT_TEST_CASE	SFGJP33
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFGJP33
; *
; *  SYSTEM SERVICE:		GETJPI
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_GJP33
; *
; *  INPUT CONDITIONS:
; *	INVALID PROCESS NAME (LENGTH 16)
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	IVLOGNAM
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_GJP	; MAKE SURE PRCNAM IS USED BY GETJPI
;
	NEXT_TEST_CASE	SFGJP34
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFGJP34
; *
; *  SYSTEM SERVICE:		GETJPI
; *
; *  ARGUMENT UNDER TEST: 	PRCNAM_GJP34
; *
; *  INPUT CONDITIONS:
; *	GETJPI ISSUED FOR EXISTING PROCESS WHICH IS NOT A
; *	  SUBPROCESS OF THIS PROCESS, AND THIS PROCESS HAS
; *	  NO GROUP OR WORLD PRIVILEGE.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	NOPRIV
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	PRIV	REM,GROUP	; REMOVE GROUP PRIVILEGE
	PRIV	REM,WORLD	; REMOVE WORLD PRIVILEGE
	CLRL	PIDADR_GJP	; MAKE SURE PRCNAM IS USED BY GETJPI
;
	NEXT_TEST_CASE	SFGJP40
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFGJP40
; *
; *  SYSTEM SERVICE:		GETJPI
; *
; *  ARGUMENT UNDER TEST: 	ITMLST_GJP40
; *
; *  INPUT CONDITIONS:
; *	ITEM LIST IN NON-ACCESSIBLE PSECT.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	ACCVIO
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	PRIV	ADD,ALL		; GET BACK ANY PRIVILEGES LOST BY PREV TEST CASE
	CLRL	PIDADR_GJP	; LET GETJPI USE PRCNAM
;
	NEXT_TEST_CASE	SFGJP41
;
;++
; ******************************************************
; *
; *  TEST CASE NAME:		SFGJP41
; *
; *  SYSTEM SERVICE:		GETJPI
; *
; *  ARGUMENT UNDER TEST: 	ITMLST_GJP41
; *
; *  INPUT CONDITIONS:
; *	ITEM LIST CONTAINS AN INVALID IDENTIFIER.
; *
; *  EXPECTED RESULTS:
; *	1) SYSTEM STATUS CODE:	BADPARAM
; *	2) REGISTERS R2 THROUGH FP UNCHANGED
; *
; ******************************************************
;--
;
	CLRL	PIDADR_GJP	; LET GETJPI USE PRCNAM
;
	TCEND
TS1:
	TESTSERV	CANWAK,ERR,SATS,				-
                                          				-
	   <1,PIDADR_CWK,						-
	        	PIDADR_CWK10,ACCVIO,	-  ; SFCWK10
	        	PIDADR_CWK11,ACCVIO,	-  ; SFCWK11
	        	PIDADR_CWK12,ACCVIO,	-  ; SFCWK12
	        	PIDADR_CWK13,NONEXPR,	-  ; SFCWK13
	        	PIDADR_CWK14,NONEXPR,	-  ; SFCWK14
                                                  >,			-
                                          				-
	   <1,PRCNAM_CWK,						-
	        	PRCNAM_CWK20,ACCVIO,	-  ; SFCWK20
	        	PRCNAM_CWK21,ACCVIO,	-  ; SFCWK21
	        	PRCNAM_CWK22,ACCVIO,	-  ; SFCWK22
	        	PRCNAM_CWK23,ACCVIO,	-  ; SFCWK23
	        	PRCNAM_CWK24,ACCVIO,	-  ; SFCWK24
                                                  >,			-
 
	TS_CLEANUP		; CLEAN UP & RETURN TO TEST_SERV_EXEC
TS2:
	TESTSERV	CANWAK,ERR,SATS,				-
                                          				-
	   <1,PIDADR_CWK,						-
                                                  >,			-
                                          				-
	   <1,PRCNAM_CWK,						-
	        	PRCNAM_CWK25,ACCVIO,	-  ; SFCWK25
	        	PRCNAM_CWK26,NONEXPR,	-  ; SFCWK26
	        	PRCNAM_CWK27,IVLOGNAM,	-  ; SFCWK27
	        	PRCNAM_CWK28,IVLOGNAM,	-  ; SFCWK28
	        	PRCNAM_CWK29,NOPRIV,	-  ; SFCWK29
                                                  >,			-
 
	TS_CLEANUP		; CLEAN UP & RETURN TO TEST_SERV_EXEC
TS3:
	TESTSERV	WAKE,ERR,SATS,				-
                                          				-
	   <1,PIDADR_WAK,						-
	        	PIDADR_WAK10,ACCVIO,	-  ; SFWAK10
	        	PIDADR_WAK11,ACCVIO,	-  ; SFWAK11
	        	PIDADR_WAK12,ACCVIO,	-  ; SFWAK12
	        	PIDADR_WAK13,NONEXPR,	-  ; SFWAK13
	        	PIDADR_WAK14,NONEXPR,	-  ; SFWAK14
                                                  >,			-
                                          				-
	   <1,PRCNAM_WAK,						-
	        	PRCNAM_WAK20,ACCVIO,	-  ; SFWAK20
	        	PRCNAM_WAK21,ACCVIO,	-  ; SFWAK21
	        	PRCNAM_WAK22,ACCVIO,	-  ; SFWAK22
	        	PRCNAM_WAK23,ACCVIO,	-  ; SFWAK23
	        	PRCNAM_WAK24,ACCVIO,	-  ; SFWAK24
                                                  >,			-
 
	TS_CLEANUP		; CLEAN UP & RETURN TO TEST_SERV_EXEC
TS4:
	TESTSERV	WAKE,ERR,SATS,				-
                                          				-
	   <1,PIDADR_WAK,						-
                                                  >,			-
                                          				-
	   <1,PRCNAM_WAK,						-
	        	PRCNAM_WAK25,ACCVIO,	-  ; SFWAK25
	        	PRCNAM_WAK26,NONEXPR,	-  ; SFWAK26
	        	PRCNAM_WAK27,IVLOGNAM,	-  ; SFWAK27
	        	PRCNAM_WAK28,IVLOGNAM,	-  ; SFWAK28
	        	PRCNAM_WAK29,NOPRIV,	-  ; SFWAK29
                                                  >,			-
 
	TS_CLEANUP		; CLEAN UP & RETURN TO TEST_SERV_EXEC
TS5:
	TESTSERV	DELPRC,ERR,SATS,				-
                                          				-
	   <1,PIDADR_DPC,						-
	        	PIDADR_DPC10,ACCVIO,	-  ; SFDPC10
	        	PIDADR_DPC11,ACCVIO,	-  ; SFDPC11
	        	PIDADR_DPC12,ACCVIO,	-  ; SFDPC12
	        	PIDADR_DPC13,NONEXPR,	-  ; SFDPC13
	        	PIDADR_DPC14,NONEXPR,	-  ; SFDPC14
                                                  >,			-
                                          				-
	   <1,PRCNAM_DPC,						-
	        	PRCNAM_DPC20,ACCVIO,	-  ; SFDPC20
	        	PRCNAM_DPC21,ACCVIO,	-  ; SFDPC21
	        	PRCNAM_DPC22,ACCVIO,	-  ; SFDPC22
	        	PRCNAM_DPC23,ACCVIO,	-  ; SFDPC23
	        	PRCNAM_DPC24,ACCVIO,	-  ; SFDPC24
                                                  >,			-
 
	TS_CLEANUP		; CLEAN UP & RETURN TO TEST_SERV_EXEC
TS6:
	TESTSERV	DELPRC,ERR,SATS,				-
                                          				-
	   <1,PIDADR_DPC,						-
                                                  >,			-
                                          				-
	   <1,PRCNAM_DPC,						-
	        	PRCNAM_DPC25,ACCVIO,	-  ; SFDPC25
	        	PRCNAM_DPC26,NONEXPR,	-  ; SFDPC26
	        	PRCNAM_DPC27,IVLOGNAM,	-  ; SFDPC27
	        	PRCNAM_DPC28,IVLOGNAM,	-  ; SFDPC28
	        	PRCNAM_DPC29,NOPRIV,	-  ; SFDPC29
                                                  >,			-
 
	TS_CLEANUP		; CLEAN UP & RETURN TO TEST_SERV_EXEC
TS7:
	TESTSERV	GETJPI,ERR,SATS,				-
                                          				-
	   <1,UNKN1_GJP,						-
                                                  >,			-
                                          				-
	   <1,PIDADR_GJP,						-
	        	PIDADR_GJP20,ACCVIO,	-  ; SFGJP20
	        	PIDADR_GJP21,NONEXPR,	-  ; SFGJP21
	        	PIDADR_GJP22,NONEXPR,	-  ; SFGJP22
                                                  >,			-
                                          				-
	   <1,PRCNAM_GJP,						-
	        	PRCNAM_GJP30,ACCVIO,	-  ; SFGJP30
	        	PRCNAM_GJP31,NONEXPR,	-  ; SFGJP31
	        	PRCNAM_GJP32,IVLOGNAM,	-  ; SFGJP32
	        	PRCNAM_GJP33,IVLOGNAM,	-  ; SFGJP33
	        	PRCNAM_GJP34,NOPRIV,	-  ; SFGJP34
                                                  >,			-
                                          				-
	   <1,ITMLST_GJP,						-
	        	ITMLST_GJP40,ACCVIO,	-  ; SFGJP40
	        	ITMLST_GJP41,BADPARAM,	-  ; SFGJP41
                                                  >,			-
                                          				-
	   <1,UNKN2_GJP,						-
                                                  >,			-
 
	TS_CLEANUP		; CLEAN UP & RETURN TO TEST_SERV_EXEC
	.SBTTL	EXECUTE & CLEANUP
EXECUTE:
	TEST_SERV_EXEC			; EXECUTE ALL T. CASES IN ALL GROUPS
CLEANUP:
	PRIV	ADD,ALL			; ENSURE THAT ALL PRIVS ARE PRESENT
	$WAKE_S	PRCNAM=DETNAME		; WAKE DETACHED PROCESS ...
					; ... TO ALLOW HIS EXIT
	$QIOW_S	CHAN=MBXCHAN, FUNC=#IO$_READVBLK, -
		P1=MBXBUFF+8, P2=MBXBUFF
					; ... AND WAIT 4 PROC TO BE DELETED
	$DELMBX_S  MBXCHAN		; DELETE TERMINATION MAILBOX
	BSBW	MOD_MSG_PRINT		; PRINT TEST MODULE END MSG
	INSV	#1,#STS$V_INHIB_MSG,#1,MOD_MSG_CODE 
					; INHIBIT PRINTING
	$EXIT_S	MOD_MSG_CODE		; EXIT TO OP SYS WITH MSG CODE
	.PAGE
	.SBTTL	TC_CONTROL
;++
; FUNCTIONAL DESCRIPTION:
;
;		THE TC_CONTROL SUBROUTINE IS CALLED BY THE TEST_SERV_EXEC
; MACRO TO EXECUTE A GROUP OF TEST CASES. A GROUP IS DEFINED BY A TC_GROUP
; MACRO. FOR EACH TC_GROUP MACRO, THERE IS A CORRESPONDING TESTSERV MACRO.
; TESTSERV CONTAINS CODE TO EXECUTE SYSTEM SERVICES AND CHECK THE RETURNED
; STATUS CODE VALUES. TESTSERV ARGUMENTS ARE CODED TO SPECIFY ALL THE SYSTEM
; SERVICE ARGUMENT VALUES AND THE EXPECTED STATUS CODE FOR EACH TEST CASE
; DEFINED BY A NEXT_TEST_CASE MACRO WITHIN THE GROUP. TC_CONTROL USES A
; CO-ROUTINE INTERFACE TO ENTER THE CODE OF THE APPROPRIATE TESTSERV MACRO
; IN VARIOUS PLACES. THE FIRST ENTRY OCCURS ONCE PER GROUP TO ALLOW TESTSERV
; TO DO SOME INITIALIZATION. THEN TWO ENTRIES ARE MADE FOR EACH TEST CASE IN
; THE GROUP. THE FIRST ALLOWS TESTSERV TO ISSUE THE SUBJECT SYSTEM SERVICE.
; THE SECOND ENTRY FOR THE TEST CASE CAUSES TESTSERV TO CHECK THE RETURNED
; STATUS CODE, PRINTING A FAILURE MESSAGE IF IT IS NOT THE EXPECTED CODE.
; IF THERE ARE NO MORE TEST CASES IN THE CURRENT GROUP, TESTSERV (NOT TC_CONTROL)
; RETURNS DIRECTLY TO TEST_SERV_EXEC (RSB ACTUALLY ISSUED IN TS_CLEANUP MACRO)
; FROM THIS SECOND ENTRY; OTHERWISE, CONTROL RETURNS TO TC_CONTROL WHICH
; IN TURN ENTERS TESTSERV AGAIN FOR THE NEXT TEST CASE. THE FAILURE OF A
; TEST CASE DOES NOT CAUSE TERMINATION OF THE TEST MODULE.
;
; CALLING SEQUENCE:
;
;	BSBW TC_CONTROL (ISSUED WITHIN THE TEST_SERV_EXEC MACRO)
;			(RSB IS ISSUED WITHIN THE TS_CLEANUP MACRO)
;
; INPUT PARAMETERS:
;
;	NONE
;
; IMPLICIT INPUTS:
;
;	ARGUMENTS SPECIFIED ON EACH TESTSERV MACRO MAY BE VIEWED AS
;	INPUTS, SINCE TC_CONTROL AND TESTSERV ACT AS CO-ROUTINES.
;
; OUTPUT PARAMETERS:
;
;	SEVERITY CODE FIELD OF MOD_MSG_CODE (BITS 0,1,2) IS SET TO ERROR
;	IF ANY TEST CASE IN THE CURRENT GROUP FAILS; OTHERWISE IT REMAINS
;	SET TO SUCCESSFUL.
;
; IMPLICIT OUTPUTS:
;
;	%UETP-I-TEXT,   ERROR MESSAGES ARE WRITTEN TO SYS$OUTPUT BY
;			THE TESTSERV MACRO (CO-ROUTINE WITH TC_CONTROL)
;
; COMPLETION CODES:
;
;	NONE
;
; SIDE EFFECTS:
;
;	NONE
;
;--



TC_CONTROL:
	PUSHL	TS_EP			; PUSH TESTSERV ENTRY POINT
	JSB	@(SP)+			; ENTER TESTSERV INITIALIZATION
10$:					; PROCESS NEXT TEST CASE
	MOVB	#^A/ /,$$TSTN$$+2 	; MAKE SURE T.C. NAME HAS A BLANK
	BSBW	REG_SAVE		; SAVE REGISTERS
	JSB	@CURRENT_TC		; JUMP TO CURRENT TEST CASE
	BSBW	REG_REST		; RESTORE REGS FOR TESTSERV
	JSB	@(SP)+			; LET TESTSERV ISSUE SYSTEM SERVICE
	BSBW	REG_COMP		; COMPARE REGS TO SEE IF ...
					; ... SYSTEM SERVICE CHANGED ANY
	JSB	@(SP)+			; LET TESTSERV CHEK S.S. STATUS CODE
	CMPB	#^A/*/,$$TSTN$$+2	; HAS TESTSERV INDICATED FAILURE ?
	BNEQU	10$			; NO -- PROCESS NEXT TEST CASE
	MOVAL	TEST_MOD_FAIL,TMD_ADDR	; YES -- INDICATE FAILED IN END MSG
	INSV	#ERROR,#0,#3,MOD_MSG_CODE ; ADJUST STATUS CODE FOR ERROR
	BRB	10$			; LOOP BAK TO PROCESS NEXT TEST CASE
;
;   TC_CONTROL RETURNS TO TEST_SERV_EXEC VIA TESTSERV (IN TS_CLEANUP MACRO)
;
	.PAGE
	.SBTTL	SUBROUTINES
REG_SAVE:
;
;  *****************************************************************
;  *                                                               *
;  *  SAVES R0 THRU SP IN REG_SAVE_AREA                            *
;  *                                                               *
;  *****************************************************************
;
	PUSHR	#R0_THRU_SP		; SAVE ALL REGS ON STACK
	MOVC3	#60,(SP),REG_SAVE_AREA	; SAVE REGS (BEFORE S.S.)
	POPR	#R0_THRU_SP		; CLEAN UP STACK
	RSB				; .... AND RETURN
;
;
;
;
REG_REST:
;
;
;  *****************************************************************
;  *                                                               *
;  *  RESTORES R0 THRU SP FROM REG_SAVE_AREA                       *
;  *                                                               *
;  *****************************************************************
;
	SUBL2	#60,SP			; MOVE SP TO MAKE ROOM FOR REGS
	MOVC3	#60,REG_SAVE_AREA,(SP)	; MOVE REGS ONTO STACK FOR POP
	POPR	#R0_THRU_SP		; RESTORE ALL REGS FOR TESTSERV
	RSB				; ... AND RETURN
	.PAGE
REG_COMP:
;
;  *****************************************************************
;  *                                                               *
;  *  1) PUSHES ALL REGS ONTO STACK                                *
;  *  2) COMPARES REGISTER IMAGES FROM STACK WITH CORRESPONDING    *
;  *       IMAGES FROM REG_SAVE_AREA FOR ALL REGISTERS SPECIFIED   *
;  *       IN REG_COMP_MASK.                                       *
;  *  3) FOR EACH UNEQUAL COMPARE, AN ERROR MESSAGE IS PRINTED     *
;  *       (USING $FAO AND $OUTPUT SYSTEM SERVICES).               *
;  *  4) POPS ALL REGS OFF OF STACK                                *
;  *                                                               *
;  *****************************************************************
;
	PUSHR	#R0_THRU_SP		; SAVE ALL REGISTERS ON STACK
	MOVAL	REG_SAVE_AREA,R6 	; POINT R6 TO BEG OF ...
					; ... REGS (BEFORE S.S.)
	MOVL	SP,R4			; POINT R4 TO BEG OF

					; ... REGS (AFTER S.S.)
	CVTBL	#-1,R3			; INITIALIZE REG_COMP_MASK INDEX
REG_COMP_NEXT:
	INCL	R3			; POINT TO NEXT BIT IN MASK
	CMPB	#15,R3			; END OF THE MASK ?
	BGTRU	REG_COMP_CONT		; NO -- CONTINUE
	BRW	REG_COMP_RSB		; YES -- GO TO COMMON RETURN
REG_COMP_CONT:
	CMPL	(R6)+,(R4)+		; REG BEFORE = REG AFTER ?
	BEQLU	REG_COMP_NEXT		; YES -- LOOK FOR NEXT REG
	BBC	R3,REG_COMP_MASK,REG_COMP_NEXT
					; NO -- GET NEXT IF BIT NOT SET
	MOVL	R3,CLOB_REG_NO		; NO -- GIVE REG NUMBER TO FAO
	MOVL	-4(R6),REG_BEFORE_SS 	; GIVE "BEFORE" CONTENTS TO FAO
	MOVL	-4(R4),REG_AFTER_SS  	; GIVE "AFTER" CONTENTS TO FAO
	MOVB	#^A/*/,$$TSTN$$+2 	; GIVE FAILURE INDIC'N IN ERROR MSG
;
	$FAO_S	ERR_MSG_FAOCTL,OUTL,OUTD,$$SNAD$$,  -
		$$ASEQ$$,$$PSEQ$$,CLOB_REG_NO,REG_BEFORE_SS,REG_AFTER_SS
;
	MOVW	OUTL,OUTD		; ACTUAL OUTPUT LEN IN STRING DESC'R
	PUTMSG	<#UETP$_TEXT,#1,#OUTD>	; PRINT THE MSG
	MOVW	#OUTE-OUTB,OUTD		; GET MAX LEN BACK INTO DESCRIPTOR
	MOVB	#^A/ /,$$TSTN$$+2 	; REMOVE FAIL INDIC'N FOR NEXT MSG
	MOVAL	TEST_MOD_FAIL,TMD_ADDR	; INDICATE FAILED IN END MSG
	INSV	#ERROR,#0,#3,MOD_MSG_CODE ; ADJUST STATUS CODE FOR ERROR
	BRW	REG_COMP_NEXT		; GO LOOK FOR NEXT REG TO COMPARE
REG_COMP_RSB:
	POPR	#R0_THRU_SP		; CLEAN UP STACK
	RSB				; RETURN TO CALLER
	.PAGE
MOD_MSG_PRINT:
;
;  *****************************************************************
;  *                                                               *
;  *  PRINTS THE TEST MODULE BEGUN/SUCCESSFUL/FAILED MESSAGES      *
;  *	   (USING THE PUTMSG MACRO).                               *
;  *                                                               *
;  *****************************************************************
;
	PUTMSG	<MOD_MSG_CODE,#2,TMN_ADDR,TMD_ADDR> ; PRINT MSG
	RSB				; ... AND RETURN TO CALLER
;
CHMRTN:
; **********************************************************
; *
; *	CHANGE MODE ROUTINE. THIS ROUTINE GETS CONTROL WHENEVER
; *	A CMKRNL, CMEXEC, OR CMSUP SYSTEM SERVICE IS ISSUED
; *	BY THE MODE MACRO ('TO' OPTION).  IT MERELY DOES 
; *	A JUMP INDIRECT ON A FIELD SET UP BY MODE. IT HAS 
; *	THE EFFECT OF RETURNING TO THE END OF THE MODE
; *	MACRO EXPANSION.
; *
; *************************************************************
;
	.WORD	0			; ENTRY MASK
	JMP	@CHM_CONT		; RETURN TO MODE MACRO IN NEW MODE
;
; *	RET INSTR WILL BE ISSUED IN EXPANSION OF 'MODE FROM, ....' MACRO
;
	.END	SATSSF07
