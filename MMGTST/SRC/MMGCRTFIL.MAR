;
;		MEMORY MANAGEMENT SERVICES TEST SUPPORT
;
;
	.TITLE  MMGCRTFIL - CREATES A FILE 10 PAGES LONG 
	.IDENT  'V03-000'
;
;
;	THIS PROGRAM CREATES A FILE N PAGES LONG ( N BEING SET BY NOPAGES).
;	THIS FILE IS USED BY SEVERAL OF THE SYSTEM SERVICES IN THE MEMORY
;	MANAGEMENT TESTS.
;
;

	.TITLE	CRTFIL		; CREATE A FILE
	.LIST	MEB
	NOPAGES==10		; LENGTH OF FILE

	.PSECT	DATA	NOEXE,WRT

NEWFAB:	$FAB	-
	FNM=<MMGTST.DAT;1>,	-
	ALQ=NOPAGES,	-
	FOP=SUP,	-
	FAC=<BRO,UPD>,	-
	MRS=512,	-
	RFM=FIX
NEWRAB:	$RAB	-
	FAB=NEWFAB,	-
	RBF=NEWFAB,	-
	RSZ=512

	.PSECT	MAIN	EXE,NOWRT

START::
	.WORD	0
	$CREATE	NEWFAB		;MAKE A NEW FILE & OPEN IT
	BLBC	R0,EXIT		;EXIT IF ERROR ENCOUNTERED
	$CONNECT NEWRAB		;CONNECT RAB TO FAB
	BLBC	R0,EXIT		;EXIT IF ERROR ENCOUNTERED
	MOVL	#NOPAGES,R5	;SET COUNT FOR PAGES TO WRITE
100$:	$WRITE	RAB=NEWRAB	;WRITE OUT A PAGE
	BLBC	R0,EXIT		;EXIT IF ERROR ENCOUNTERED
	SOBGTR	R5,100$		;LOOP FOR MORE
	$CLOSE	NEWFAB		;CLOSE FILE
EXIT:	$EXIT_S	R0

	.END	START
